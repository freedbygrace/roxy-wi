[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
loglevel=info

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
priority=10
stdout_logfile=/var/log/nginx/access.log
stderr_logfile=/var/log/nginx/error.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB

[program:roxy-wi]
command=python -m flask run --host=127.0.0.1 --port=8000
directory=/var/www/haproxy-wi
user=roxy-wi
environment=FLASK_APP="app:app",PYTHONPATH="/var/www/haproxy-wi"
autostart=true
autorestart=true
priority=20
stdout_logfile=/var/log/roxy-wi/flask.log
stderr_logfile=/var/log/roxy-wi/flask-error.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB

[program:roxy-wi-scheduler]
command=python -c "from app import scheduler; scheduler.start(); import time; time.sleep(86400)"
directory=/var/www/haproxy-wi
user=roxy-wi
environment=PYTHONPATH="/var/www/haproxy-wi"
autostart=true
autorestart=true
priority=30
stdout_logfile=/var/log/roxy-wi/scheduler.log
stderr_logfile=/var/log/roxy-wi/scheduler-error.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB
startsecs=10

